{
  "name" : "job-stocks-prices-2020",
  "description" : "",
  "role" : "arn:aws:iam::331504768406:role/service-role/AWSGlueServiceRole",
  "executionProperty" : {
    "maxConcurrentRuns" : 1
  },
  "command" : {
    "name" : "glueetl",
    "scriptLocation" : "s3://aws-glue-assets-331504768406-us-east-1/scripts/job-stocks-prices-2020.py",
    "pythonVersion" : "3"
  },
  "defaultArguments" : {
    "--enable-glue-datacatalog" : "true",
    "--job-bookmark-option" : "job-bookmark-enable",
    "--datalake-formats" : "delta",
    "--TempDir" : "s3://aws-glue-assets-331504768406-us-east-1/temporary/",
    "--enable-metrics" : "true",
    "--enable-spark-ui" : "true",
    "--extra-py-files" : "s3://aws-glue-studio-transforms-510798373988-prod-us-east-1/gs_common.py,s3://aws-glue-studio-transforms-510798373988-prod-us-east-1/gs_sequence_id.py,s3://aws-glue-studio-transforms-510798373988-prod-us-east-1/gs_now.py,s3://aws-glue-studio-transforms-510798373988-prod-us-east-1/gs_derived.py,s3://aws-glue-studio-transforms-510798373988-prod-us-east-1/gs_uuid.py",
    "--spark-event-logs-path" : "s3://aws-glue-assets-331504768406-us-east-1/sparkHistoryLogs/",
    "--enable-job-insights" : "true",
    "--enable-observability-metrics" : "true",
    "--conf" : "spark.sql.extensions=io.delta.sql.DeltaSparkSessionExtension --conf spark.sql.catalog.spark_catalog=org.apache.spark.sql.delta.catalog.DeltaCatalog",
    "--enable-continuous-cloudwatch-log" : "true",
    "--job-language" : "python"
  },
  "maxRetries" : 0,
  "allocatedCapacity" : 10,
  "timeout" : 5,
  "maxCapacity" : 10.0,
  "glueVersion" : "4.0",
  "numberOfWorkers" : 10,
  "workerType" : "G.1X",
  "executionClass" : "FLEX",
  "codeGenConfigurationNodes" : "{\"node-1703983975953\":{\"SelectFields\":{\"Inputs\":[\"node-1703981794057\"],\"Name\":\"Select Fields\",\"Paths\":[[\"ticker\"],[\"ticker_type\"],[\"city\"],[\"country\"],[\"industry\"],[\"long_name\"],[\"price_ticker\"],[\"price_date\"],[\"vl_close\"],[\"vl_volume\"],[\"price_ymd\"],[\"z_score\"],[\"perc_change_day\"],[\"vl_moving_avg_200_days\"],[\"vl_change_day\"],[\"ymd\"]]}},\"node-1703984422888\":{\"DynamicTransform\":{\"FunctionName\":\"gs_sequence_id\",\"Inputs\":[\"node-1703984361109\"],\"Name\":\"Identifier\",\"Parameters\":[{\"IsOptional\":true,\"Name\":\"colName\",\"Type\":\"str\",\"Value\":[\"_id_number\"]},{\"IsOptional\":true,\"Name\":\"unique\",\"Type\":\"bool\",\"Value\":[\"true\"]}],\"Path\":\"s3://aws-glue-studio-transforms-510798373988-prod-us-east-1/gs_sequence_id.py\",\"TransformName\":\"gs_sequence_id\",\"Version\":\"1.0.0\"}},\"node-1703981407588\":{\"ApplyMapping\":{\"Inputs\":[\"node-1703983321500\"],\"Mapping\":[{\"Dropped\":false,\"FromPath\":[\"ticker\"],\"FromType\":\"string\",\"ToKey\":\"price_ticker\",\"ToType\":\"string\"},{\"Dropped\":false,\"FromPath\":[\"price_date\"],\"FromType\":\"string\",\"ToKey\":\"price_date\",\"ToType\":\"string\"},{\"Dropped\":true,\"FromPath\":[\"vl_open\"],\"FromType\":\"double\",\"ToKey\":\"vl_open\",\"ToType\":\"double\"},{\"Dropped\":true,\"FromPath\":[\"vl_high\"],\"FromType\":\"double\",\"ToKey\":\"vl_high\",\"ToType\":\"double\"},{\"Dropped\":true,\"FromPath\":[\"vl_low\"],\"FromType\":\"double\",\"ToKey\":\"right_vl_low\",\"ToType\":\"double\"},{\"Dropped\":false,\"FromPath\":[\"vl_close\"],\"FromType\":\"double\",\"ToKey\":\"vl_close\",\"ToType\":\"double\"},{\"Dropped\":true,\"FromPath\":[\"vl_adj_close\"],\"FromType\":\"double\",\"ToKey\":\"vl_adj_close\",\"ToType\":\"double\"},{\"Dropped\":false,\"FromPath\":[\"vl_volume\"],\"FromType\":\"double\",\"ToKey\":\"vl_volume\",\"ToType\":\"double\"},{\"Dropped\":true,\"FromPath\":[\"vl_dividends\"],\"FromType\":\"double\",\"ToKey\":\"right_vl_dividends\",\"ToType\":\"double\"},{\"Dropped\":true,\"FromPath\":[\"vl_splits\"],\"FromType\":\"double\",\"ToKey\":\"vl_splits\",\"ToType\":\"double\"},{\"Dropped\":true,\"FromPath\":[\"vl_capital_gains\"],\"FromType\":\"double\",\"ToKey\":\"vl_capital_gains\",\"ToType\":\"double\"},{\"Dropped\":false,\"FromPath\":[\"ymd\"],\"FromType\":\"string\",\"ToKey\":\"price_ymd\",\"ToType\":\"string\"},{\"Dropped\":false,\"FromPath\":[\"z_score\"],\"FromType\":\"double\",\"ToKey\":\"z_score\",\"ToType\":\"double\"},{\"Dropped\":false,\"FromPath\":[\"vl_change_day\"],\"FromType\":\"double\",\"ToKey\":\"vl_change_day\",\"ToType\":\"double\"},{\"Dropped\":false,\"FromPath\":[\"perc_change_day\"],\"FromType\":\"double\",\"ToKey\":\"perc_change_day\",\"ToType\":\"double\"},{\"Dropped\":true,\"FromPath\":[\"vl_change_week\"],\"FromType\":\"double\",\"ToKey\":\"right_vl_change_week\",\"ToType\":\"double\"},{\"Dropped\":true,\"FromPath\":[\"perc_change_week\"],\"FromType\":\"double\",\"ToKey\":\"right_perc_change_week\",\"ToType\":\"double\"},{\"Dropped\":true,\"FromPath\":[\"vl_change_month\"],\"FromType\":\"double\",\"ToKey\":\"right_vl_change_month\",\"ToType\":\"double\"},{\"Dropped\":true,\"FromPath\":[\"perc_change_month\"],\"FromType\":\"double\",\"ToKey\":\"right_perc_change_month\",\"ToType\":\"double\"},{\"Dropped\":true,\"FromPath\":[\"vl_moving_avg_20_days\"],\"FromType\":\"double\",\"ToKey\":\"right_vl_moving_avg_20_days\",\"ToType\":\"double\"},{\"Dropped\":false,\"FromPath\":[\"vl_moving_avg_200_days\"],\"FromType\":\"double\",\"ToKey\":\"vl_moving_avg_200_days\",\"ToType\":\"double\"}],\"Name\":\"Renamed keys\"}},\"node-1703984361109\":{\"DynamicTransform\":{\"FunctionName\":\"gs_now\",\"Inputs\":[\"node-1703984157703\"],\"Name\":\"Add Current Timestamp\",\"Parameters\":[{\"IsOptional\":true,\"Name\":\"dateFormat\",\"Type\":\"str\",\"Value\":[\"%Y-%m-%d %H:%M:%S\"]}],\"Path\":\"s3://aws-glue-studio-transforms-510798373988-prod-us-east-1/gs_now.py\",\"TransformName\":\"gs_now\",\"Version\":\"1.0.0\"}},\"node-1703987201884\":{\"S3DeltaDirectTarget\":{\"AdditionalOptions\":{},\"Compression\":\"snappy\",\"Format\":\"delta\",\"Inputs\":[\"node-1703984475870\"],\"Name\":\"Amazon S3\",\"PartitionKeys\":[[\"timestamp\"]],\"Path\":\"s3://jamil-datalake-dev/stocks-analysis/price-profile/\",\"SchemaChangePolicy\":{\"Database\":\"stocks-analysis\",\"EnableUpdateCatalog\":false,\"Table\":\"prices-profile\",\"UpdateBehavior\":\"LOG\"}}},\"node-1703981794057\":{\"DropDuplicates\":{\"Columns\":[[\"price_ticker\"],[\"price_date\"]],\"Inputs\":[\"node-1703981353703\"],\"Name\":\"Drop Duplicates\"}},\"node-1703983321500\":{\"Filter\":{\"Filters\":[{\"Negated\":false,\"Operation\":\"REGEX\",\"Values\":[{\"Type\":\"CONSTANT\",\"Value\":[\"AAPL\"]},{\"Type\":\"COLUMNEXTRACTED\",\"Value\":[\"ticker\"]}]}],\"Inputs\":[\"node-1703981027358\"],\"LogicalOperator\":\"AND\",\"Name\":\"filter-prices\"}},\"node-1703981165317\":{\"S3DeltaSource\":{\"AdditionalDeltaOptions\":{},\"AdditionalOptions\":{\"EnableSamplePath\":false,\"SamplePath\":\"s3://jamil-lakehouse-silver/stocks-analysis/profile/ticker_type=CURRENCY/part-00000-a608ac29-82c2-4b12-a55a-a00f9ef77091.c000.snappy.parquet\"},\"Name\":\"s3-lake-profile\",\"OutputSchemas\":[{\"Columns\":[{\"Name\":\"id_profile\",\"Type\":\"string\"},{\"Name\":\"ticker\",\"Type\":\"string\"},{\"Name\":\"ticker_type\",\"Type\":\"string\"},{\"Name\":\"city\",\"Type\":\"string\"},{\"Name\":\"state\",\"Type\":\"string\"},{\"Name\":\"zip\",\"Type\":\"string\"},{\"Name\":\"country\",\"Type\":\"string\"},{\"Name\":\"phone\",\"Type\":\"string\"},{\"Name\":\"website\",\"Type\":\"string\"},{\"Name\":\"industrykey\",\"Type\":\"string\"},{\"Name\":\"industry\",\"Type\":\"string\"},{\"Name\":\"sectorkey\",\"Type\":\"string\"},{\"Name\":\"sector\",\"Type\":\"string\"},{\"Name\":\"business_summary\",\"Type\":\"string\"},{\"Name\":\"employees\",\"Type\":\"double\"},{\"Name\":\"currency\",\"Type\":\"string\"},{\"Name\":\"payout_ratio\",\"Type\":\"double\"},{\"Name\":\"market_cap\",\"Type\":\"double\"},{\"Name\":\"enterprise_value\",\"Type\":\"double\"},{\"Name\":\"shares_float\",\"Type\":\"double\"},{\"Name\":\"shares_outstanding\",\"Type\":\"double\"},{\"Name\":\"short_name\",\"Type\":\"string\"},{\"Name\":\"long_name\",\"Type\":\"string\"},{\"Name\":\"time_zone\",\"Type\":\"string\"},{\"Name\":\"ymd\",\"Type\":\"string\"}]}],\"Paths\":[\"s3://jamil-lakehouse-silver/stocks-analysis/profile/\"]}},\"node-1703981027358\":{\"S3DeltaSource\":{\"AdditionalDeltaOptions\":{},\"AdditionalOptions\":{\"EnableSamplePath\":false,\"SamplePath\":\"s3://jamil-lakehouse-silver/stocks-analysis/prices/ticker=AAPL/part-00000-08d3a291-84bf-45ae-8c14-bc43c3704482.c000.snappy.parquet\"},\"Name\":\"s3-lake-price\",\"OutputSchemas\":[{\"Columns\":[{\"Name\":\"ticker\",\"Type\":\"string\"},{\"Name\":\"price_date\",\"Type\":\"string\"},{\"Name\":\"vl_open\",\"Type\":\"double\"},{\"Name\":\"vl_high\",\"Type\":\"double\"},{\"Name\":\"vl_low\",\"Type\":\"double\"},{\"Name\":\"vl_close\",\"Type\":\"double\"},{\"Name\":\"vl_adj_close\",\"Type\":\"double\"},{\"Name\":\"vl_volume\",\"Type\":\"double\"},{\"Name\":\"vl_dividends\",\"Type\":\"double\"},{\"Name\":\"vl_splits\",\"Type\":\"double\"},{\"Name\":\"vl_capital_gains\",\"Type\":\"double\"},{\"Name\":\"ymd\",\"Type\":\"string\"},{\"Name\":\"z_score\",\"Type\":\"double\"},{\"Name\":\"vl_change_day\",\"Type\":\"double\"},{\"Name\":\"perc_change_day\",\"Type\":\"double\"},{\"Name\":\"vl_change_week\",\"Type\":\"double\"},{\"Name\":\"perc_change_week\",\"Type\":\"double\"},{\"Name\":\"vl_change_month\",\"Type\":\"double\"},{\"Name\":\"perc_change_month\",\"Type\":\"double\"},{\"Name\":\"vl_moving_avg_20_days\",\"Type\":\"double\"},{\"Name\":\"vl_moving_avg_200_days\",\"Type\":\"double\"}]}],\"Paths\":[\"s3://jamil-lakehouse-silver/stocks-analysis/prices/\"]}},\"node-1703984157703\":{\"DynamicTransform\":{\"FunctionName\":\"gs_derived\",\"Inputs\":[\"node-1703983975953\"],\"Name\":\"Derived Column\",\"Parameters\":[{\"IsOptional\":false,\"Name\":\"colName\",\"Type\":\"str\",\"Value\":[\"new_vl_percent_day\"]},{\"IsOptional\":false,\"Name\":\"expr\",\"Type\":\"str\",\"Value\":[\"vl_close * perc_change_day /100\"]}],\"Path\":\"s3://aws-glue-studio-transforms-510798373988-prod-us-east-1/gs_derived.py\",\"TransformName\":\"gs_derived\",\"Version\":\"1.0.0\"}},\"node-1703981353703\":{\"Join\":{\"Columns\":[{\"From\":\"node-1703981407588\",\"Keys\":[[\"price_ticker\"]]},{\"From\":\"node-1703993401056\",\"Keys\":[[\"sector\"]]}],\"Inputs\":[\"node-1703981407588\",\"node-1703993401056\"],\"JoinType\":\"right\",\"Name\":\"Join\"}},\"node-1703984475870\":{\"DynamicTransform\":{\"FunctionName\":\"gs_uuid\",\"Inputs\":[\"node-1703984422888\"],\"Name\":\"UUID\",\"OutputSchemas\":[{\"Columns\":[{\"Name\":\"ticker\",\"Type\":\"string\"},{\"Name\":\"ticker_type\",\"Type\":\"string\"},{\"Name\":\"city\",\"Type\":\"string\"},{\"Name\":\"country\",\"Type\":\"string\"},{\"Name\":\"industry\",\"Type\":\"string\"},{\"Name\":\"long_name\",\"Type\":\"string\"},{\"Name\":\"price_ticker\",\"Type\":\"string\"},{\"Name\":\"price_date\",\"Type\":\"string\"},{\"Name\":\"vl_close\",\"Type\":\"double\"},{\"Name\":\"vl_volume\",\"Type\":\"double\"},{\"Name\":\"price_ymd\",\"Type\":\"string\"},{\"Name\":\"z_score\",\"Type\":\"double\"},{\"Name\":\"perc_change_day\",\"Type\":\"double\"},{\"Name\":\"vl_moving_avg_200_days\",\"Type\":\"double\"},{\"Name\":\"vl_change_day\",\"Type\":\"double\"},{\"Name\":\"ymd\",\"Type\":\"string\"},{\"Name\":\"new_vl_percent_day\",\"Type\":\"double\"},{\"Name\":\"timestamp\",\"Type\":\"string\"},{\"Name\":\"_id_number\",\"Type\":\"decimal(10,2)\"},{\"Name\":\"_uuid\",\"Type\":\"string\"}]}],\"Parameters\":[{\"IsOptional\":true,\"Name\":\"colName\",\"Type\":\"str\",\"Value\":[\"_uuid\"]}],\"Path\":\"s3://aws-glue-studio-transforms-510798373988-prod-us-east-1/gs_uuid.py\",\"TransformName\":\"gs_uuid\",\"Version\":\"1.0.0\"}},\"node-1703993401056\":{\"Filter\":{\"Filters\":[{\"Negated\":false,\"Operation\":\"REGEX\",\"Values\":[{\"Type\":\"CONSTANT\",\"Value\":[\"AAPL\"]},{\"Type\":\"COLUMNEXTRACTED\",\"Value\":[\"ticker\"]}]}],\"Inputs\":[\"node-1703981165317\"],\"LogicalOperator\":\"AND\",\"Name\":\"filter progile\"}}}",
  "sourceControlDetails" : {
    "provider" : "GITHUB",
    "repository" : "aws-product-review-analysis",
    "branch" : "2023-12-31-aws-glue",
    "folder" : "jobs-glue"
  }
}